<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN"
 "task.dtd">
<?Pub Sty _display FontColor="red"?>
<?Pub Inc?>
<task id="t_ingress_install" xml:lang="en-us">
  <title>Installing Ingress</title>
  <shortdesc>When running Kubernetes on-prem, managing load-balancing must be considered for
    Sametime Meetings and Web Chat. Both of these Sametime features require the addition of an
    ingress controller.<draft-comment author="debra.taylor"> not ready</draft-comment></shortdesc>
  <taskbody>
    <prereq id="prereq_rnm_dyj_mvb">
      <p>Ingress is secured with a SSL certificate which must be created. Create a secret for
        ingress by following the steps in <xref href="tls_change_certificate_kubernetes.dita"
          format="dita" scope="local"/>.</p>
      <p>If different the host names for Web Chat and Meetings are different, open the
          <filepath>values.yaml</filepath> file and add the following line to identify the Web Chat
        host name.
        <codeblock id="codeblock_fn4_swc_pvb">extraChatHostname: <varname>web_chat_hostname</varname></codeblock>Verify
        that there are two spaces at the beginning of the line. Save and close the
          <filepath>values.yaml</filepath> file.</p>
    </prereq>
    <context id="context_qxz_1yj_mvb">
      <p>There are many different ingress controllers available, however; not all of them have been
        tested with Sametime. The procedure in this topic describes deploying the NGINX Ingress
        controller. If you are using another ingress controller, refer to the documentation for that
        ingress controller.</p>
      <p>An Ingress controller is also used for the Connect and Embedded clients mux traffic
        deployed on-premise Kubernetes. After installing the ingress controller, additional
        configuraiton steps are needed. See<xref href="t_ingress_configure.dita" format="dita"
          scope="local"/> for details.</p>
      <p>Helm commands are used to install and configure the NGINX Ingress controller.</p>
    </context>
    <steps id="steps_sgh_bzj_mvb">
      <step>
        <cmd>Add the <filepath>nginx</filepath> repository using the <cmdname>helm repo</cmdname>
          command.</cmd>
        <info>
          <codeblock id="codeblock_qrk_3zj_mvb">
helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx</codeblock>
        </info>
      </step>
      <step>
        <cmd>Update the repository with the following command.</cmd>
        <info>
          <codeblock id="codeblock_nhy_kzj_mvb">
helm repo update</codeblock>
        </info>
      </step>
      <step>
        <cmd>Run the following command to install NGINX.</cmd>
        <info><codeblock id="codeblock_tmw_4zj_mvb">helm install nginx-ingress ingress-nginx/ingress-nginx --set controller.service.loadBalancerIP=<varname>IP_address</varname> </codeblock>Where
            <varname>IP_address</varname> is the reserved IP address.</info>
        <info>If you have a namespace dedicated to Sametime, include the
            <parmname>namespace</parmname> option on the command.</info>
      </step>
      <step>
        <cmd>Verify that nginx-ingress has accepted the correct static IP address by running the
            <cmdname>kubectl get</cmdname> command.  Includes the <parmname>-w</parmname> parameter.
            <draft-comment author="debra.taylor">I didn't understand what this meant - and will
            update when the IP address is assigned.</draft-comment> To break free from this, use
          Ctrl+C. </cmd>
        <info>
          <codeblock id="codeblock_ong_13d_pvb">kubectl get services -o wide -w nginx-ingress-ingress-nginx-controller </codeblock>
        </info>
        <info>Use Contl+C to return to the command prompt.</info>
      </step>
    </steps>
  </taskbody>
</task>
<?Pub *0000003147?>
