<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="ltpa_configure_kubernetes" xml:lang="en-us">
    <title>Configuring LTPA in Kubernetes</title>
    <shortdesc>This topic includes the steps to configure LTPA keys on Kubernetes.</shortdesc>
    <taskbody>
        <prereq id="prereq_sfc_t2j_rtb">You must have already created a secret that contains your
            LPTA keys before you can compete this task. For more information on using WebSphere
            Liberty to generate LTPA keys, see <xref href="ltpa_generate_key.dita" scope="local"
                format="dita"/>.<p>If LTPA was not selected during the install process, you must add
                it to the <filepath>sametime.ini</filepath> file to use LTPA authentication. Edit
                the <filepath>sametime.ini</filepath> file and verify that <codeph>Ltpa</codeph> is
                included on the following line. If not, add it before continuing with configuring
                LTPA
                    steps.<codeblock id="codeblock_ybv_dnd_35b">STI_ST_BB_NAMES_ST_AUTH_TOKEN=Fork:Jwt, Ltpa</codeblock><note
                    id="note_u5n_2nd_35b">There are two double underscores after STI and
                    NAMES.</note></p></prereq>
        <context id="context_fzg_3qh_k5b">
            <p>The changes in this task affect the following pods:<ul id="ul_yqd_j1d_d5b">
                    <li>community</li>
                </ul></p>
        </context>
        <steps id="steps_m3g_mdj_rtb">
            <step>
                <cmd>Create a secret that contains your LTPA keys.</cmd>
                <info>
                    <codeblock id="codeblock_tnx_tw3_5tb">kubectl create secret generic ltpa-keys --from-file=./ltpa.keys </codeblock>
                </info>
            </step>
            <step>
                <cmd>Change to the <filepath>helm/templates</filepath>directory and open open the
                        <filepath>sametime-secrets.yaml</filepath> file.</cmd>
            </step>
            <step>
                <cmd>Find the base64 encoded value for your pass code. </cmd>
                <info>To base64 encode the password, you can enter the following command in a Linux
                    shell:
                    <codeblock id="codeblock_gns_r4h_k5b">echo -n <varname>ltpa_key_password</varname></codeblock></info>
            </step>
            <step>
                <cmd>Locate the <codeph>LtpaKeysPassword</codeph> line and replace the existing text
                    with the base64 encoded LTPA key password.</cmd>
            </step>
            <step>
                <cmd>Save and close the <filepath>sametime-secrets.yaml</filepath> file.</cmd>
            </step>
            <step>
                <cmd>In the <filepath>values.yaml</filepath> file set <codeph>enableLtpa</codeph> to
                    true.</cmd>
                <info><codeph>enableLtpa = true</codeph></info>
            </step>
            <step
                conref="securing_ldap_kubernetes.dita#securing_ldap_kubernetes/apply_changes_helmupgrade">
                <cmd/>
            </step>
            <step conref="pod_apply_changes.dita#pod_apply_changes/scale_pod">
                <cmd/>
            </step>
        </steps>
    </taskbody>
</task>
