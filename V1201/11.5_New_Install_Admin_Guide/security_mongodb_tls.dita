<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="security_mongodb_tls" xml:lang="en-us">
<title>Enabling TLS for the Mongo database</title>
<shortdesc>You can update the MongoDB connection with the Sametime Community server to encrypt data
flowing between the Sametime server and a TLS enabled MongoDB.</shortdesc>
<taskbody>
<prereq>You must have a TLS enabled MongoDB server. For details, refer to the topic <xref
href="https://docs.mongodb.com/manual/tutorial/configure-ssl/" scope="external" format="html"
>Configure mongod and mongos for TLS/SSL</xref> in the MongoDB documentation.</prereq>
<context>
<p>During Sametime Meeting installation, the <filepath>chatlogging.ini</filepath> file is created to
contain MongoDB server connection information. The connection configuration information within the
<filepath>chatlogging.ini</filepath> file must be modified to include parameters necessary to
establish a secure connection.</p>
<p>The Sametime administrator can specify a custom connection URL to the MongoDB server. The
CL_MONGO_URL configuration parameter can be set with a MongoDB server URL which includes the
required settings for the Sametime server to establish a secure connection to the MongoDB server.
After adding the CL_MONGO_URL configuration parameter to the <filepath>chatlogging.ini</filepath>
file, the default setting is overridden by the settings contained within the URL string.</p>
<p> If a self-signed certificate is being used, the certificate must be added to the Sametime
certificate store.</p>
</context>
<steps>
<step>
<cmd>Open the <filepath>chatlogging.ini</filepath> file which is in the HCL Notes data directory
.</cmd>
</step>
<step>
<cmd>Update or add the <codeph>CL_MONGO_URL</codeph> configuration parameter.</cmd>
<info>This parameter is used to override existing configuration settings specified during
installation. If changes were made post installation, this parameter exists in the file. If no
changes have been made, add the
parameter.<p><codeblock>CL_MONGO_URL=mongodb://user:password@<varname>hostname_tcpip</varname>:<varname>port</varname>/<varname>tls_information</varname></codeblock> where:<dl>
<dlentry>
<dt>hostname_tcpip</dt>
<dd>The hostname or TCPIP address of the MongoDB server.</dd>
</dlentry>
<dlentry>
<dt>port</dt>
<dd>The port to be used for communication.</dd>
</dlentry>
<dlentry>
<dt>tls_information</dt>
<dd>The attributes that identify use of a TLS MongoDB.  Copy and past the following into the
<codeph>CL_MONGO_URL</codeph>
parameter.<codeblock> /admin?retryWrites=true&amp;w=majority&amp;ssl=true&amp;tlsCAFile=/local/notesdata/cacert.pem</codeblock></dd>
</dlentry>
</dl> For example:
<codeblock>CL_MONGO_URL=mongodb://user:password@192.168.150.1:27017/admin?retryWrites=true&amp;w=majority&amp;ssl=true&amp;tlsCAFile=/local/notesdata/cacert.pem</codeblock></p></info>
</step>
<step>
<cmd>Save the file and restart the Sametime Community server to apply the changes.</cmd>
</step>
</steps>
</taskbody>
</task>
