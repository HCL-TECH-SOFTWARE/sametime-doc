<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="t_namechange_docker">
    <title>Updating user IDs</title>
    <taskbody>
        <prereq id="prereq_xhc_vfg_mvb">Stop the Sametime server prior to running the Sametime
            database utility. Refer to <xref href="starting_and_stopping_servers.dita"/> for the
            steps.</prereq>
        <context>
            <p>The ID task works by comparing existing user IDs with the names provided in the CSV
                list, and replacing the IDs when a match is found. By default, comparisons are case
                sensitive. The ID task allows case-insensitive comparisons of user IDs by adding
                    <parmname>NC_ID_TASK_CASE_INSENSITIVE=1</parmname> to the
                    <codeph>sametime.ini</codeph> file. For more information, refer to <xref
                    href="st_adm_comm_manageclientlogin_c.dita"/>.</p>
            <p>After installing the Sametime Server, you can find the Sametime database utility in
                the image repository. Any system with access to the image repository and the mongo
                server can run the utility.</p>
        </context>
        <steps>
            <step>
                <cmd>Using a text editor, create a CSV file for only one type of change. You cannot
                    mix name change types in the same CSV. Follow the syntax below. The file must be
                    saved in UTF-8 format.</cmd>
                <info>
                    <codeblock id="codeblock_utc_chh_mvb">ID
"old ID", "new ID"[,"new display name"]</codeblock>
                </info>
                <info>For example,<codeblock id="codeblock_hm4_hpb_nvb">ID
"Maria Smith," "Maria Smith-Brown"[,"Maria Brown"]</codeblock></info>
                <info>
                    <note id="note_nnn_22h_mvb">The brackets [ ] indicate that the new display name
                        is optional. If you use it, you must precede it with a comma. The new
                        display name must immediately follow the comma. Do not leave a blank space
                        between the comma and the new display name.</note>
                </info>
            </step>
            <step>
                <cmd>Copy the CSV file into an accessible read or writable location.</cmd>
            </step>
            <step>
                <cmd>Edit the .env file used to contain the environment variables. Follow the syntax
                    below.</cmd>
                <info>
                    <codeblock id="codeblock_zkj_bfh_mvb">MONGO_CONNECTION_URL=mongodb://sametimeUser:xxxxxxxx@192.168.1.1:27017/admin?authSource=admin&amp;authMechanism=SCRAM-SHA-256&amp;readPreference=primary&amp;directConnection=true&amp;ssl=false
USER_ID_CSV=/data/test_id.csv</codeblock>
                </info>
            </step>
            <step>
                <cmd>Run the command below manually on a stand-alone community server or on a server
                    in a cluster which replicates the change throughout the cluster. The CSV file is
                    mounted in the container for the application to access and process.</cmd>
                <info>
                    <codeblock id="codeblock_dgz_rnk_nvb">docker run -v &lt;path-to-data-directory>:&lt;path-to-data-directory>:rw --env-file default.env hclcr.io/st/sametime-db-utility</codeblock>
                </info>
            </step>
        </steps>
        <postreq id="postreq_l5j_t2b_nvb">Verify if the changes have been applied. For more
            information, refer to <xref href="t_verify_namechange.dita"/>. Below is a sample CSV
            showing changes from an LDAP
            directory:<codeblock id="codeblock_std_zmb_nvb">ID
"CN=Maria Smith,OU=Sales,O=HCL",
	"CN=Maria Brown,OU=Sales,O=HCL",
	"Maria Brown"
"CN=John,OU=New York,O=HCL",
	"CN=John,OU=Texas,O=HCL"
"CN=Old Group,OU=groups,O=HCL",
	"CN=New Group Name,OU=groups,O=HCL",
	"New Group Name"</codeblock></postreq>
    </taskbody>
</task>
