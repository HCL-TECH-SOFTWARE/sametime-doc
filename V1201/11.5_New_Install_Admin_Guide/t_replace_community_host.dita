<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="t_replace_community_host">
    <title>Changing the community host</title>
    <shortdesc></shortdesc>
    <taskbody>
        <prereq id="prereq_yvv_b4b_nvb">
            <ol id="ol_zvv_b4b_nvb">
                <li>Generate a textual output of vpuserinfo.nsf into CSV files. For more
                    information, refer to <xref href="t_report_mongodb.dita"/>.</li>
                <li>Stop the Sametime server prior to running the Sametime database utility. Refer
                    to <xref href="starting_and_stopping_servers.dita"/> for the steps.</li>
            </ol>
        </prereq>
        <context id="context_awv_b4b_nvb">
            <p>To change the community host for all users, follow these steps:</p>
        </context>
        <steps id="steps_cwv_b4b_nvb">
            <step>
                <cmd>Using a text editor, create a CSV file for only one type of change. You cannot
                    mix name change types in the same CSV. Follow the syntax in the example below.
                    The file must be saved in UTF-8 format.</cmd>
                <info>
                    <codeblock id="codeblock_jth_24b_nvb">REPLACE_HOST
orig1.server.com, new1.server.com
orig2.server.com, new2.server.com </codeblock>
                </info>
            </step>
            <step>
                <cmd>Copy the CSV file into an accessible read or writable location.</cmd>
            </step>
            <step>
                <cmd>Edit the .env file used to contain the environment variables. Follow the syntax
                    below.</cmd>
                <info>
                    <codeblock id="codeblock_ewv_b4b_nvb">MONGO_CONNECTION_URL=mongodb://sametimeUser:xxxxxxxx@192.168.1.1:27017/admin?authSource=admin&amp;authMechanism=SCRAM-SHA-256&amp;readPreference=primary&amp;directConnection=true&amp;ssl=false
USER_ID_CSV=/data/test_id.csv</codeblock>
                </info>
            </step>
            <step>
                <cmd>Run the command below manually on a stand-alone community server or on a server
                    in a cluster which replicates the change throughout the cluster. The CSV file is
                    mounted in the container for the application to access and process.</cmd>
                <info>
                    <codeblock id="codeblock_fwv_b4b_nvb">docker run -v local.csv:/data/local.csv --env-file default.env docker-prod.artifactory.cwp.pnp-hcl.com/name-change-prod</codeblock>
                </info>
            </step>
        </steps>
        <postreq id="postreq_gwv_b4b_nvb">Generate a report to check if the changes have been
            applied. For more information, refer to <xref href="t_verify_namechange.dita"
            />.</postreq>
    </taskbody>
</task>
