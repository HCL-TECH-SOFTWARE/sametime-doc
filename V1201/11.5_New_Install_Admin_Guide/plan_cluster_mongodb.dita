<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="plan_cluster_mongodb" xml:lang="en-us">
    <title>Configuring MongoDB for high availability</title>
    <shortdesc/>
    <taskbody>
        <context>
            <p>Beginning in Sametime 12.0, MongoDB clustering is handled during the install process
                for both Docker and Kubernetes.</p>
            <note id="note_gbs_h4s_3tb">In the MongDB URL, if the user name or password includes the
                following characters, they must be converted by using a percent sign: / ? # [ ] :
                @.</note>
        </context>
    </taskbody>
    <task id="ncl_ddm_x5b">
        <title>Configuring MongoDB clustering on Docker</title>
        <taskbody>
            <context>In the <filepath>custom.env</filepath> configuration file on the Sametime
                server, update the MONGO_ URL field. For information about how to create the MongoDB
                URL, see the <xref
                    href="https://docs.mongodb.com/manual/reference/connection-string/"
                    format="html" scope="external">Connection String URI Format</xref> topic in the
                MongoDB documentation.</context>
        </taskbody>
    </task>
    <task id="nky_cdm_x5b">
        <title>Configuring MongoDB clustering on Kubernetes</title>
        <taskbody>
            <steps>
                <step>
                    <cmd>Provide a single node MongoDB information while running the
                            <cmdname>prepareDeployement</cmdname> script.</cmd>
                </step>
                <step>
                    <cmd> When the prepareDeployement process is complete, prepare your MongoDB
                        cluster URL. For how to prepare the MongoDB URL, see the <xref
                            href="https://docs.mongodb.com/manual/reference/connection-string/"
                            format="html" scope="external">Connection String URI Format</xref> topic
                        in the MongoDB documentation. </cmd>
                </step>
                <step>
                    <cmd>Use Base64 encoding to encrypt your MongoDB URL.</cmd>
                    <info>You can review online websites that provide Base64 encoding or you can set
                        up one on your own.</info>
                </step>
                <step>
                    <cmd>Use the <cmdname>kubectl</cmdname> command to update the
                            <codeph>sametime-meetings-global-secrets</codeph> secret configuration
                        file.</cmd>
                    <info>
                        <codeblock>kubectl edit secret sametime-meetings-global-secrets</codeblock>
                    </info>
                </step>
                <step>
                    <cmd>Inside the <codeph>sametime-meetings-global-secrets</codeph>, locate the
                            <codeph>MongoConnectionUrl</codeph> section. Replace the value for it
                        with the value from Step 3.</cmd>
                </step>
                <step>
                    <cmd>Save your changes.</cmd>
                </step>
            </steps>
        </taskbody>
    </task>
</task>
