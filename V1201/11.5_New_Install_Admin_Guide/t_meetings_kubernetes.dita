<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<?Pub Sty _display FontColor="red"?>
<?Pub Inc?>
<task id="t_meetings_kubernetes" xml:lang="en-us">
  <title>Configuring host aliases for Kubernetes deployments </title>
  <shortdesc>If your Kubernetes environment is unable to consistently resolve the host names of the
    supporting servers (MongoDB, Sametime Proxy, STUN) using DNS, configure the hosts manually.  </shortdesc>
 <taskbody>
<context>
      <p>In Kubernetes, you can add host names and their corresponding IP addresses to the host
        aliases. In a Sametime Meetings on Kubernetes deployment, this setting is defined in the
          <filepath>deployment.yaml</filepath> in the various templates for each Kubernetes pod. </p>
      <p>Table 1 lists the pod name and template for each host to be resolved.</p>
      <p>Modify each template specified in Table 1 to include the host name and IP address of the
        required supporting server.</p>
      <p>Complete the following steps to modify each template in the table to include the host name
        and IP address of each supporting server.</p>
      <note>
        <ul id="ul_kzx_kgq_znb">
          <li>When modifying yaml files, do not use the tab key for indentation, when using
            indentation use two spaces for each indentation. </li>
          <li>This process should be completed for all templates involved.</li>
          <li>There should be no extra blank lines in the template. </li>
        </ul>
      </note>
      <p><b>Procedure </b></p>
      <p>
        <table frame="all" rowsep="1" colsep="1" id="table_jk5_jn2_ynb">
          <title>Template names, pod names and hosts to resolve. </title>
          <tgroup cols="3">
            <colspec colname="c1" colnum="1" colwidth="1*"/>
            <colspec colname="c2" colnum="2" colwidth="1*"/>
            <colspec colname="c3" colnum="3" colwidth="1*"/>
            <thead>
              <row>
                <entry>Hostname to resolve</entry>
                <entry>Pod</entry>
                <entry>Template name</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>MongoDB</entry>
                <entry>community</entry>
                <entry>helm/charts/community/templates/pod.yaml</entry>
              </row>
              <row>
                <entry>MongoDB</entry>
                <entry>proxy</entry>
                <entry>helm/charts/proxy/templates/deployment.yaml</entry>
              </row>
              <row>
                <entry>MongoDB</entry>
                <entry>catalog </entry>
                <entry>helm/charts/catalog/templates/deployment.yaml </entry>
              </row>
              <row>
                <entry>LDAP</entry>
                <entry>community</entry>
                <entry>helm/charts/catalog/templates/deployment.yaml </entry>
              </row>
              <row>
                <entry>STUN server </entry>
                <entry>video</entry>
                <entry>helm/charts/video/templates/deployment.yaml </entry>
              </row>
              <row>
                <entry>Recording repository and Sametime server</entry>
                <entry>recordings </entry>
                <entry>helm/charts/recordings/templates/deployment.yaml </entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </p>
      <p>
        <ol id="ol_rz2_wn2_ynb">
          <li>Open the template using a text editor and place into edit mode. <p>Locate the line
                <codeph>restartPolicy=Always</codeph> and insert a new line. </p><p>Use the below
              example text as a template and include the host names that need to be resolved:
              <codeblock> 
hostAliases: 
    - hostnames: 
      - "ldap.company.com" 
      ip: "10.10.10.10" 
    - hostnames: 
      - "mongodb.company.com" 
      ip: "10.10.10.11" 
</codeblock></p><p>
              <note>In the <codeph>hostnames</codeph> field your server might only be known as one
                host name, you can add multiple aliases if desired. </note>
            </p></li>
          <li>Before saving the template, ensure the indentations are correct, using only spaces for
            indentation. The <codeph>hostAliases:</codeph> line should line up exactly under the
              <codeph>restartPolicy</codeph> line at the same level of indentation. You may need to
            correct the other lines as well after copy and pasting them.</li>
          <li>Save and close the template when changes are complete.  </li>
        </ol>
      </p>
    </context>
    <postreq id="postreq_smx_y42_ynb">
      <p>After this process is complete continue to the steps to install Sametime, see <xref
          href="t_meetings_sametime_image_docker.dita"/>. If Sametime is already installed, follow
        the procedures in the  <xref href="apply_configchanges_kubernetes.dita" scope="local"
          format="dita"/> topic to apply the changes.</p>
    </postreq>
 </taskbody>
</task>
<?Pub *0000003147?>
