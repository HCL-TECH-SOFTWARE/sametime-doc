<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="task_ar1_cnv_dlb" xml:lang="en-us">
<title>Securing connections between Sametime servers and LDAP</title>
    <shortdesc>When Sametime is configured to connect to an LDAP server, the Sametime servers makes
        five separate connections to the LDAP server.</shortdesc>
<taskbody>
<context otherprops="notready">
            <p><b>This text is marked "not ready" for the public server. Shows only on the review
                    server. There is a comment that this topic needs updating or removing. Issue
                    44523.</b></p>
            <p>The Sametime Community Server makes a separate connection to the LDAP server to
                perform each of these five tasks: <ul>
                    <li>Authenticate users.</li>
                    <li>Resolve a user name to a distinguished name as part of the login
                        procedure.</li>
                    <li>Resolve user and group names (for example, as a response to an "Add Person
                        or Group" request from a Sametime Connect Client).</li>
                    <li>Browse the directory.</li>
                    <li>Get the content of public groups.</li>
                </ul></p>
            <p>The Sametime Community Server and LDAP servers exchange directory information,
                including user names and passwords, over these connections. To ensure this
                information is secure, the administrator can use SSL to encrypt the data that passes
                over these connections. The administrator should consider the level of protection
                required before enabling SSL. Using SSL to encrypt these connections can slow the
                server performance. </p>
            <p>The administrator has the following options when using SSL to encrypt the data
                transmitted between the Sametime and LDAP servers: <ul>
                    <li><b>Encrypt all data</b> - This option encrypts all directory information
                        (both user names and passwords) that is transmitted between the Sametime
                        Community Server and the LDAP server. If you encrypt all data, all five
                        connections between the Sametime Community Server and LDAP server are
                        encrypted with SSL. This option provides the most security but also has the
                        greatest effect on server performance.</li>
                    <li><b>Encrypt only user passwords</b> - This option encrypts passwords but no
                        other directory information (such as usernames) passing over the connections
                        between the Sametime Community Server and LDAP servers. If you encrypt only
                        user passwords, only the "authenticating users" connection between the
                        Sametime server and the LDAP server is encrypted with SSL. This option
                        provides an intermediate level of security and has less effect on server
                        performance than encrypting all the data.</li>
                    <li><b>Encrypt no data</b> - This option allows all directory information and
                        passwords to pass unencrypted between the Sametime and LDAP servers. This
                        option does not affect server performance and should be used if the
                        administrator feels there is no chance that an unauthorized user can
                        intercept information transmitted over the connections between the Sametime
                        and LDAP servers. This is the default setting, if you wish to encrypt no
                        data, no additional steps are necessary.  </li>
                    <li><b>Using SSL to encrypt connections between the Sametime Userinfo servlet
                            and LDAP</b> - This option secures the communication for the business
                        card data. </li>
                </ul></p>
            <p><b>Prerequisites</b></p>
            <p>You must already have created the TLS Trust Store in .p12 or .jks format.  </p>
            <p>You can configure Sametime LDAP to use the same TLS settings as the rest of the
                server by setting the configuration at the global scope, or the LDAP settings can be
                secured using its own key store and settings by following the instructions in the
                Individual TLS scope and using the pre-fix STLDAP_.   You must configure the
                sametime.ini settings by completing one of these topics:  </p>
            <p>
                <ul id="ul_jqk_lh5_p4b">
                    <li><xref href="implement_tls_configuration.dita">Implementing the Global TLS
                            Scope </xref></li>
                    <li><xref href="implement_tls_configuration_individual.dita">Implementing the
                            Individual TLS Scope</xref>
                    </li>
                </ul>
            </p>
            <p><b>Procedure</b></p>
            <p>Follow these steps to encrypt all data as explained above. </p>
            <p><b>Import the LDAP server’s certificate into the trust store </b></p>
            <p>If the LDAP server is using a public certificate, then you need to obtain the public
                root CA and import it into the trust store on the Sametime server. If your LDAP
                server is using a self-signed certificate, then you simply import the self-signed
                certificate. In the prerequisite topics, your trust store filename is defined in
                sametime.ini setting ST_TLS_TRUST_STORE_FILE or if using the individual scope in
                STLDAP_TLS_TRUST_STORE_FILE.  If you are securing Sametime using the global scope,
                the LDAP connections can use the same key and trust stores and these sametime.ini
                parameters are not needed. </p>
            <p><b>Update the stconfig.nsf to use the secure LDAP settings </b></p>
            <p>See the topic <xref href="configuring_ldap_server_document.dita">Configuring the
                    LDAPServer Document</xref> and <ul>
                    <li>Set the Connection settings to the secure LDAP port (typically 636). </li>
                    <li>Set the field <uicontrol>SSL Enabled </uicontrol> to true. </li>
                </ul></p>
            <p><b>Update the userinfoconfig.xml to use the secure LDAP settings </b></p>
            <p>By default, the business cards LDAP connection is unsecure. To secure these settings,
                see the topic <xref href="config_buscard.dita">Configuring Business cards using an
                    LDAP Directory</xref> and complete the optional step <uicontrol>“Enabling
                    Encryption”</uicontrol>.</p>
            <p><b>Encrypt only password related operations</b></p>
            <p>If you wish to only encrypt operations that involve passwords, the rest of the
                traffic can remain unencrypted (sent in the clear), follow these steps:<ol>
                    <li>Remote to the Sametime Community Server.</li>
                    <li>Open the sametime.ini file using a text editor (located in the Domino
                        program directory).</li>
                    <li>In the [Directory] section add the following line:
                            <p>ST_DB_LDAP_SSL_ONLY_FOR_PASSWORDS=1</p></li>
                    <li>Save and close the sametime.ini file.</li>
                    <li>Restart Sametime Server for the change to take effect.</li>
                </ol></p>
        </context>
</taskbody>
</task>
